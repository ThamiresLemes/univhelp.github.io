!function(m,p,f,e){"use strict";var g={};function h(e){var t=g.getDoc(),n=t.getCursor(),i=t.getLine(n.line),r={line:n.line};i.match(/\S/i)?t.replaceRange("\n"+e,r):t.replaceRange(e,r)}m(f).ready(function(){var i=p.ajaxUrl||"",r=p.menuId||0,n=p.lang||{},e=p.Twig||{},t={},a={},o={},l="";e.extendFunction("lang",function(e){return void 0!==n[e]?n[e]:e}),m(f).ajaxSend(function(e,t,n){n.url+=0<=n.url.indexOf("?")?"&":"?",n.url+="menu_id="+r}),m(".items-list").iconPicker({selector:".icon-select",onSelect:function(e,t){var n=e.parentsUntil("li").parent().attr("id").substring(5);a.treeBuilder("updateItem",{item_icon:t},n)}});var u=m("#sm-menus").on("click",".menu-option",function(e){r=+m(this).parent().attr("id").substring(5),m(this).parent().parent().children().removeClass("row3 current-menu"),m(this).parent().addClass("row3 current-menu"),a.treeBuilder("getItems"),e.preventDefault()}).on("click",".menu-edit",function(e){var t=m(this).parent().prev().removeClass("menu-option").parent().removeClass("current-menu").find(".menu-editable");l=t.text(),s.show().appendTo(t.text("")).children(":input").val(l).focus().select().end(),e.preventDefault()}).on("click",".menu-delete",function(e){o.dialog({buttons:t}).dialog("open"),e.preventDefault()}),s=m('<form id="inline-menu-form"><input type="text" id="inline-menu-edit" value="" /></form>').hide().appendTo(m("body"));a=m("#nested-tree").treeBuilder({ajaxUrl:i,editForm:"#edit-menu-item-form",dialogEdit:"#dialog-edit-menu-item",dialogConfirm:"#dialog-confirm-menu-item"}),m(".toggle-view").click(function(e){m(m(this).attr("href")).slideToggle(),e.preventDefault()}),m("#add-menu").button().click(function(e){r=0,m.getJSON(i+"add_menu",function(e){if(null!==e.id){var t='<li id="menu-'+(r=e.id)+'" class="row3 current-menu">';t+='<a href="#" class="menu-option"><span class="menu-editable">'+e.title+"</span></a>",t+='<div class="menu-actions">',t+='<a href="#" class="menu-edit left" title="'+n.edit+'"><span class="ui-icon ui-icon-gear"></span></a>',t+='<a href="#" class="menu-delete left" title="'+n.remove+'"><span class="ui-icon ui-icon-trash"></span></a>',t+="</span></li>",u.children("li").removeClass("row3 current-menu"),u.append(t),a.show().treeBuilder("getItems")}}),e.preventDefault()}),m("#inline-menu-form").submit(function(e){e.preventDefault(),m(this).children("#inline-menu-edit").trigger("blur")}),m("#inline-menu-edit").focusout(function(e){var t=m(this).val(),n=m(this).val("").parent().parent();r&&t&&t!==l?m.post(i+"edit_menu",{title:t},function(e){e.name&&n.text(e.name)}):t=l,s.hide().appendTo(m("body")),n.text(t).parent().addClass("menu-option").parent().addClass("current-menu"),e.preventDefault()}),t[n.remove]=function(){r&&m.getJSON(i+"delete_menu",function(e){if(e.id===r){var t=m("#menu-"+r),n=t.prev(),i=t.next();n.length?n.find(".menu-option").trigger("click"):i.length?i.find(".menu-option").trigger("click"):p.location.reload(!1),t.remove()}}),m(this).dialog("close")},t[n.cancel]=function(){m(this).dialog("close")},o=m("#dialog-confirm-menu").dialog({autoOpen:!1,modal:!0,width:"auto",show:"slide",hide:"slide"}),r&&a.show(),g=m("#nested-tree").treeBuilder("getCodeMirrorInstance"),m(".bulk-type").button().click(function(e){e.preventDefault(),h(m(this).data("items").trim())}).each(function(e,t){var i=[],n=m(this).data("items").trim().split("\n");m.each(n,function(e,t){var n=t.split("|");i.push('<a href="#" data-item="'+t+'">'+n[0].replace(/\t/g,"&nbsp; &nbsp;")+"</a>")}),m(t).siblings(".bulk-dropdown").children(".inner").html(i.join("<br />"))});var c=m(".bulk-type-items").on("click","a",function(e){e.preventDefault(),h(m(this).data("item").trim()),m(this).parents(".bulk-type-items").toggle()});m(".bulk-type-list").button({text:!1,icons:{primary:"ui-icon-triangle-1-n"}}).click(function(e){e.preventDefault(),c.hide();var t=m(e.currentTarget),n=t.next(),i=t.offset(),r=n.height(),a=n.width();n.toggle().offset({top:i.top-r,left:i.left-a/2-t.width()})}).parent().buttonset();var d=0;g.on("keyup",function(e){var t=e.getDoc().getLine(e.getCursor().line).match(/\s/gim);d=t?t.length:0}),g.on("change",function(n,i){var r=d*n.options.tabSize;n.operation(function(){for(var e=i.from.line+1,t=CodeMirror.changeEnd(i).line;e<=t;++e)n.indentLine(e,r)})})})}(jQuery,window,document);
//# sourceMappingURL=admin.min.js.map
